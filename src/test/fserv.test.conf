# fserv-0.17

root "/usr/local/fserv"

mod "log.log" {
}

# set global server log
log "log.log" {
	level debug
	pass_to_std true
	debug "file" {
		file "log/debug.log"
		buffer_size 0
	}
}

mod "cache.mem" {
}

mod "net.resolve" {
	server "8.8.8.8"
	server "127.0.0.1"

	cache "cache.mem" {
		max_items 1000
	}
}

mod "net.connect" {
	dns_resolver "net.resolve" {
	}
}

mod "net.listen" {
	max_clients 1
}

mod "test.test" {
	cache "cache.mem" {
		max_items 2
		expiry 2
		max_age 3
		max_data 10
		mem_limit 10
	}
	cache_multi "cache.mem" {
	}

	server "net.listen" {
		listen ":64001"
	}
	client "net.connect" {
		server {
			url "http://[::1]:64001"
		}
	}

	resolve "net.resolve" {
	}

	connect "net.connect" {
		server {
			url "http://server1"
		}
		server {
			url "http://127.0.0.1:64000"
			weight 2
		}
		server {
			url "http://$my_var/some/path"
		}
		keepalive_cache "cache.mem" {
			expiry 1
		}
	}
}
